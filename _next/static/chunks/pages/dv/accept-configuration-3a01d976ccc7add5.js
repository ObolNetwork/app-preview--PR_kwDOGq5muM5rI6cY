(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6107],{16411:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dv/accept-configuration",function(){return n(37801)}])},37801:function(e,s,n){"use strict";n.r(s);var i=n(85893),t=n(24967),o=n(61472),r=n(12606),a=n(86105),c=n(98682),l=n(87536),d=n(56081),h=n(15497),u=n(31431),x=n(11163),g=n(13976),p=n(67294),f=n(31417),j=n(91997),v=n(70521),m=n(37122),b=n(92321);let AcceptConfiguration=()=>{let e=(0,m.Z)(),{address:s,chainId:n}=(0,b.m)(),{control:C,handleSubmit:$,formState:{isDirty:k,isValid:w}}=(0,l.cI)({mode:"onChange"}),y=(0,x.useRouter)(),[_,S]=(0,p.useState)(!1),[N,E]=(0,p.useState)(!1),[I,R]=(0,p.useState)(),[A,W]=(0,p.useState)(""),z=(0,c.o)(e=>e.clusterDefinitionData),T=(0,c.o)(e=>e.updateJoinFirstStep),D=(0,c.o)(e=>e.completeOperatorStep),O=(0,c.o)(e=>e.enableOperatorStep),handleContinue=()=>{D("dv-accept-config");let e=O("dv-dkg");y.push(e.href)};(null==z?void 0:z.config_hash)&&T("/dv#".concat(null==z?void 0:z.config_hash));let{isBlocked:Z}=(0,d.Sh)(s),onSubmit=async i=>{if(!N&&!Z)try{W(""),E(!0);let t={operator_config_hash:null==z?void 0:z.config_hash},o=await (0,h.AM)(n,s,t,e),r={enr:i.enr},c=await (0,h.Ol)(n,s,r,e),l={address:s,enr:i.enr,enr_signature:c,fork_version:a.se,version:null==z?void 0:z.version},{data:d}=await (0,u.R)({token:o,data:l,configHash:null==z?void 0:z.config_hash});R(d),E(!1)}catch(e){var t,o;console.log(e),W(null===(o=e.response)||void 0===o?void 0:null===(t=o.data)||void 0===t?void 0:t.message),E(!1)}},{data:F}=(0,g.ZP)("/definition/".concat(null==z?void 0:z.config_hash),u.FU,{refreshInterval:e=>(null==e?void 0:e.definition_hash)?0:1e3});if(!F)return(0,i.jsx)(o.xv,{children:"Loading..."});let L="".concat(a.yK,"/dv#").concat(F.config_hash);if((0,h.YC)(null==F?void 0:F.operators)&&(null==F?void 0:F.definition_hash))return(0,i.jsx)(()=>(0,i.jsxs)(o.kC,{direction:"column",css:{gap:"$2xl"},children:[(0,i.jsx)(o.xv,{variant:"h3",children:"Accept Configuration"}),(0,i.jsx)(r.qN,{}),(0,i.jsxs)(o.W2,{className:"success-section",alignItems:"start",css:{gap:"$xs"},children:[(0,i.jsxs)(o.kC,{css:{backgroundColor:"$bg03",borderRadius:"$1",gap:"$xs",p:"$sm",boxSizing:"border-box",width:"$full"},children:[(0,i.jsx)(o.xu,{children:(0,i.jsx)(o.nQ,{})}),(0,i.jsx)(o.xv,{variant:"body",css:{fontWeight:"$bold",color:"$light"},children:(0,v.c)("biaClaimPage")?"\n            The Bia is now complete, please proceed to claiming ETH.":" All operators can now proceed to the Distributed Key Generation\n            phase"})]}),(0,i.jsx)(o.kC,{css:{gap:"$lg"},children:(0,i.jsx)(o.zx,{fullWidth:!0,onClick:()=>handleContinue(),children:"Continue to DKG"})})]})]}),{});let P=F.operators.find(e=>{var n;return(null==e?void 0:null===(n=e.address)||void 0===n?void 0:n.toLowerCase())===(null==s?void 0:s.toLowerCase())});return(0,h._h)(P)&&!I&&R(P),(0,i.jsxs)(o.kC,{direction:"column",css:{gap:"$2xl"},children:[(0,i.jsx)(r.wc,{href:"/dv/advisories"}),(0,i.jsx)(o.xv,{variant:"h3",children:I?"Waiting for all participants to accept configuration":"Accept Configuration"}),(0,i.jsx)(t.l0,{onSubmit:$(onSubmit),children:(0,i.jsxs)(o.kC,{direction:"column",css:{gap:"$2xl"},children:[(0,i.jsx)(()=>(0,i.jsx)(o.W2,{className:"cluster-details",alignItems:"start",children:(0,i.jsxs)(o.kC,{direction:"column",css:{gap:"$2xl"},children:[(0,i.jsx)(j.uo,{flow:"joinClusterFlow"}),(0,i.jsx)(j.SS,{operators:null==F?void 0:F.operators})]})}),{}),(0,i.jsx)(j.Zz,{validators:null==F?void 0:F.validators}),I?(0,i.jsx)(o.W2,{className:"waiting-section",alignItems:"start",css:{gap:"$lg"},children:(0,i.jsx)(()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(o.kC,{css:{backgroundColor:"$bg03",borderRadius:"$1",gap:"$xs",p:"$sm",boxSizing:"border-box",width:"$full"},children:[(0,i.jsx)(o.xu,{children:(0,i.jsx)(o.nQ,{})}),(0,i.jsx)(o.xv,{variant:"body",css:{fontWeight:"$bold",color:"$light"},children:"Confirmation signature successfully submitted"})]}),(0,i.jsxs)(o.kC,{css:{backgroundColor:"$bg03",borderRadius:"$1",gap:"$xs",p:"$sm",boxSizing:"border-box",width:"$full"},children:[(0,h.YC)(null==F?void 0:F.operators)?(0,i.jsx)(o.xu,{children:(0,i.jsx)(o.nQ,{})}):(0,i.jsx)(o.xu,{children:(0,i.jsx)(o.ZG,{})}),(0,i.jsx)(o.kC,{css:{fd:"column",gap:"$xs"},children:(0,i.jsx)(o.xv,{variant:"body",css:{fontWeight:"$bold",color:"$light"},children:"Awaiting all group signatures to proceed to Distributed Key Generation."})})]}),(0,i.jsx)(r.DM,{heading:"Group Invite Link",content:L})]}),{})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(o.W2,{className:"enr-section",alignItems:"start",css:{gap:"$lg"},children:[(0,i.jsxs)(o.kC,{direction:"column",css:{gap:"$sm"},children:[(0,i.jsxs)(o.kC,{css:{alignItems:"center",gap:"$xxxs"},children:[(0,i.jsx)(o.xv,{variant:"subline",color:"body",css:{textTransform:"uppercase"},children:"Your Charon client ENR"}),(0,i.jsx)(o.KZ,{content:'An ENR is an "Ethereum Node Record" used to identify your client to the other clients in the cluster"',children:(0,i.jsx)(o.xu,{css:{display:"flex"},children:(0,i.jsx)(o.by,{})})})]}),(0,i.jsx)(f.i,{control:C,name:"enr"})]}),(0,i.jsxs)(o.rU,{href:"https://docs.obol.org/next/learn/charon/cluster-configuration#cluster-size-and-resilience/start/quickstart_group#step-1-generate-an-enr",target:"_blank",children:["More on Ethereum Node Records ",(0,i.jsx)(o.ZJ,{})]})]}),(0,i.jsxs)(o.W2,{className:"confirm-details-section",alignItems:"start",css:{gap:"$lg"},children:[(0,i.jsx)(o.xv,{variant:"h4",children:"Confirm Details"}),(0,i.jsxs)(o.kC,{css:{gap:"$xs",width:"$full"},children:[(0,i.jsx)(o.xu,{children:(0,i.jsx)(o.XZ,{checked:_,onCheckedChange:()=>S(!_)})}),(0,i.jsx)(o.xv,{variant:"body",children:"You will be prompted to sign a message with your wallet. This signature is attesting to the fact that:"})]}),(0,i.jsx)(o.sQ,{heading:"You have confirmed the withdrawal address for the validators to be created is correct. If this address is a contract, you have confirmed the contract implementation is correct. If this address is an externally-owned account, you have confirmed that the EOA custody is secure. This address is where the principal and rewards for all created validators will be credited to and the address cannot be modified."}),(0,i.jsx)(o.sQ,{heading:"You have submitted your charon node's Ethereum Node Record (ENR) correctly. This signature is the authorisation of this charon client to act on your behalf."}),A&&(0,i.jsxs)(o.mh,{css:{backgroundColor:"$test"},children:[(0,i.jsx)(o.xu,{children:(0,i.jsx)(o.zM,{size:"lg",color:"body"})}),(0,i.jsx)(o.kC,{direction:"column",css:{gap:"$sm"},children:(0,i.jsx)(o.kC,{direction:"column",css:{gap:"$xs"},children:(0,i.jsx)(o.xv,{color:"textLight",children:A})})})]}),(0,i.jsxs)(o.kC,{direction:"column",children:[(0,i.jsx)(o.zx,{color:"primary",type:"submit",css:{"& div":{m:0}},disabled:!k||!w||!s||!_||!!A,children:(0,i.jsxs)(i.Fragment,{children:[N&&(0,i.jsx)(o.yC,{}),"Confirm and Sign"]})}),!s&&(0,i.jsx)(o.xv,{variant:"metadata",color:"test",children:"Please connect your wallet"})]})]})]})]})})]})};s.default=AcceptConfiguration,AcceptConfiguration.layout="OperatorProgressTrackerLayout"}},function(e){e.O(0,[9774,2888,179],function(){return e(e.s=16411)}),_N_E=e.O()}]);