(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[873],{54839:function(t,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/exit/monitor",function(){return r(45804)}])},32890:function(t,e,r){"use strict";r.d(e,{X:function(){return ErrorPageContainer}});var s=r(85893);r(67294);var a=r(61472);let ErrorPageContainer=t=>{let{children:e,css:r={}}=t;return(0,s.jsxs)(a.W2,{css:{borderRadius:0,marginTop:"$7xl",...r},children:[(0,s.jsx)(a.xv,{variant:"h4",children:"Error"}),(0,s.jsx)(a.xv,{variant:"body",children:e})]})}},73818:function(t,e,r){"use strict";r.d(e,{E:function(){return ActionButtons}});var s=r(85893),a=r(61472);r(67294);let ActionButtons=t=>(0,s.jsxs)(a.kC,{css:{gap:"$sm",...t.css},children:[(0,s.jsx)(a.zx,{onClick:t.onBack,color:"secondary",children:"Back"}),(0,s.jsx)(a.zx,{className:"cta-bc-continue-button",fullWidth:!0,onClick:()=>t.onContinue(),disabled:t.disableContinue,children:"Continue"})]})},81521:function(t,e,r){"use strict";r.d(e,{f:function(){return ExitWrapper}});var s=r(85893),a=r(32890),n=r(92724),i=r(61472),o=r(15497),l=r(11163),c=r(67294),d=r(32010);let ExitWrapper=t=>{let{children:e}=t,r=(0,l.useRouter)(),{data:u}=(0,n.TY)((0,d.N)(t=>({data:t.data}))),x=(0,n.TY)(t=>t.resetState),h=(0,o.xs)(r,"lockHash");return((0,c.useEffect)(()=>{if(!u||!h||u.lockHash!==h){let t=null==u?void 0:u.lockHash;x(),t&&r.push("/cluster/details/?lockHash=".concat(u.lockHash))}},[u,x,h]),u&&h)?(0,s.jsxs)(i.kC,{direction:"column",css:{gap:"$2xl"},children:[(0,s.jsx)(i.xv,{variant:"h3",children:"Exit Validators"}),e]}):(0,s.jsx)(a.X,{children:"Error: No details information provided, please double check the link you followed or return to the home page."})}},92724:function(t,e,r){"use strict";r.d(e,{TY:function(){return c},eI:function(){return n},xM:function(){return i}});var s=r(64529),a=r(782);let n={REQUISITES:"pre-requisites",EXIT_COMMAND:"exit-command",MONITOR:"monitor",FETCH_BROADCAST:"fetch-broadcast",QUEUE:"queue"},i={REQUISITES:"/exit/pre-requisites",EXIT_COMMAND:"/exit/exit-command",MONITOR:"/exit/monitor",FETCH_BROADCAST:"/exit/fetch-broadcast",QUEUE:"/exit/queue"},o=[{id:n.REQUISITES,status:"current",title:"Pre Requisites",href:i.REQUISITES},{id:n.EXIT_COMMAND,status:"incomplete",title:"Run Exit Command",href:i.EXIT_COMMAND},{id:n.MONITOR,status:"incomplete",title:"Monitor Partial Exits",href:i.MONITOR},{id:n.FETCH_BROADCAST,status:"incomplete",title:"Fetch & Broadcast",href:i.FETCH_BROADCAST},{id:n.QUEUE,status:"incomplete",title:"Exit Queue",href:i.QUEUE}],l={steps:o,data:null},c=(0,s.Ue)()((0,a.tJ)((t,e)=>({...l,completeStep:e=>t(t=>({steps:t.steps.map(t=>t.id===e?{...t,status:"complete"}:t)})),enableStep:r=>{let s=e().steps.find(t=>t.id===r);return t(t=>({steps:s?t.steps.map(t=>t.id===s.id?{...s,status:"current"}:t):t.steps})),s},getStepByRoute:t=>e().steps.find(e=>e.href===t)||null,getCurrentStep:()=>e().steps.find(t=>"incomplete"===t.status)||e().steps[0],setData:e=>{t(t=>({steps:t.steps.map(t=>({...t,href:"".concat(t.href,"/?lockHash=").concat(null==e?void 0:e.lockHash)})),data:e}))},resetState:()=>{t(()=>({steps:l.steps,data:l.data}))}}),{name:"exit-store",getStorage:()=>localStorage}))},45804:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return monitor}});var s=r(85893),a=r(67294),n=r(11163),i=r(92724),o=r(28593),l=r(61472),c=r(81521),d=r(15497),u=r(56081);let ValidatorPubKeyCell=t=>{let{signedOperators:e,allOperators:r,children:a}=t;return(0,s.jsx)(l.xv,{css:{fontSize:"$3"},color:e===r?"body":"light",children:a})},PartialExitsSignedCell=t=>{let{signedOperators:e,allOperators:r,threshold:a}=t;return(0,s.jsxs)(l.kC,{direction:"column",css:{position:"relative"},children:[(0,s.jsxs)(l.xv,{css:{fontSize:"$3"},color:e===r?"body":"light",children:[e,"/",r]}),(0,s.jsx)(l.xu,{css:{height:"2px",position:"absolute",left:"-14px",right:"-14px",bottom:"-14px"},children:(0,s.jsx)(l.kC,{css:{height:"2px",backgroundColor:e>=a?"$obolGreen":"#E89E30",width:"".concat(Math.floor(e/r*100),"%")}})})]})},ValidatorsTable=t=>{let{validatorsData:e}=t,r=(0,i.TY)(t=>t.data);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.xv,{variant:"body",children:"Partial Exits Signed"}),(0,s.jsx)(l.iA,{rows:e.map(t=>{let{pubkey:e,exit_shares:a}=t;return{address:(0,s.jsx)(ValidatorPubKeyCell,{signedOperators:3,allOperators:4,children:(0,d.zN)(e,[0,6],5)}),partial_exits_signed:(0,s.jsx)(PartialExitsSignedCell,{signedOperators:a.length,allOperators:r.operators.length,threshold:r.threshold})}}),columns:[{accessorKey:"address",header:""},{accessorKey:"partial_exits_signed",header:""}]})]})};var x=r(12606);let ShowingItemsText=t=>{let{currentPage:e,totalCount:r,validatorsDataLength:a}=t;return(0,s.jsxs)(l.kC,{css:{gap:"$xxs"},children:[(0,s.jsx)(l.xv,{css:{fontSize:"$2"},color:"body",children:"Showing:"}),(0,s.jsx)(l.xv,{css:{fontSize:"$2"},children:(e-1)*10+a}),(0,s.jsxs)(l.xv,{css:{fontSize:"$2"},color:"body",children:["of ",r]})]})},ValidatorsDataContainer=t=>{let{searchValidatorValue:e,validatorsData:r,currentPage:a,totalCount:n,totalPages:i,onPageChange:o,onValidatorSearch:c}=t;return(0,s.jsxs)(l.W2,{alignItems:"start",css:{justifyContent:"flex-start",gap:"$lg",height:"fit-content",padding:"$xl"},children:[(0,s.jsx)(l.xv,{variant:"h5",children:"Validators"}),(0,s.jsx)(x.Vr,{value:e,setValue:c}),(0,s.jsx)(ValidatorsTable,{validatorsData:r}),(0,s.jsxs)(l.kC,{css:{justifyContent:"space-between"},children:[(0,s.jsx)(ShowingItemsText,{currentPage:a,totalCount:n,validatorsDataLength:r.length}),(0,s.jsx)(l.tl,{currentPage:a,totalPages:i,onPageChange:o})]})]})};var h=r(73818);let MonitorDataColumn=t=>{let{title:e,value:r}=t;return(0,s.jsxs)(l.xu,{css:{width:"180px"},children:[(0,s.jsx)(l.xv,{variant:"subline",color:"body",css:{textTransform:"uppercase",fontWeight:"$medium"},children:e}),(0,s.jsx)(l.xv,{variant:"subline",color:"body",css:{textTransform:"uppercase",fontWeight:"$medium",pt:"$xs"},children:r||0})]})},ExitMonitorData=()=>{let t=(0,i.TY)(t=>t.data);return(0,s.jsxs)(l.kC,{children:[(0,s.jsx)(MonitorDataColumn,{title:(0,s.jsxs)(s.Fragment,{children:["Active",(0,s.jsx)("br",{})," validators"]}),value:null==t?void 0:t.validatorsCount}),(0,s.jsx)(MonitorDataColumn,{title:(0,s.jsxs)(s.Fragment,{children:["partial exit",(0,s.jsx)("br",{})," Threshold"]}),value:null==t?void 0:t.threshold})]})},WaitingYellowIcon=()=>(0,s.jsxs)("svg",{width:"25",height:"24",viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("rect",{x:"0.5",width:"24",height:"24",rx:"12",fill:"#243D42"}),(0,s.jsx)("path",{d:"M12.5 0C5.9 0 0.5 5.4 0.5 12C0.5 18.6 5.9 24 12.5 24C19.1 24 24.5 18.6 24.5 12C24.5 5.4 19.1 0 12.5 0ZM12.5 21.6C7.208 21.6 2.9 17.292 2.9 12C2.9 6.708 7.208 2.4 12.5 2.4C17.792 2.4 22.1 6.708 22.1 12C22.1 17.292 17.792 21.6 12.5 21.6ZM13.1 6H11.3V13.2L17.54 17.04L18.5 15.48L13.1 12.24V6Z",fill:"#E89E30"})]});var p=r(11038),g=r(86744);let f=(0,g.zo)(p.xz,{background:"none",border:"none",padding:0}),C=(0,g.zo)(p.VY,{backgroundColor:"$tooltip",borderRadius:"8px",padding:"12px 16px",fontSize:"14px",maxWidth:"300px",boxShadow:"0px 10px 20px rgba(0, 0, 0, 0.2)"}),j=(0,g.zo)(p.Eh,{fill:"$tooltip",marginLeft:"22px"}),v=(0,g.zo)("button",{marginTop:"8px",backgroundColor:"$bg03",color:"#97B2B8",border:"none",borderRadius:"6px",padding:"6px 12px",fontSize:"14px",cursor:"pointer"}),PartialExitsTooltip=t=>{let{onClose:e}=t;return(0,s.jsx)(p.zt,{children:(0,s.jsxs)(p.fC,{open:!0,children:[(0,s.jsx)(f,{}),(0,s.jsxs)(C,{side:"bottom",align:"end",alignOffset:-40,children:[(0,s.jsx)(l.xv,{variant:"body",color:"muted",css:{fontWeight:"$semibold"},children:"Show Missing Partial Exits Signed:"}),(0,s.jsx)(l.xv,{color:"muted",css:{fontWeight:"$medium",lineHeight:"24px",mt:"$xxs"},children:"Discover for which Validator/s this Operator has no signed the partial exits"}),(0,s.jsx)(l.kC,{css:{justifyContent:"flex-end"},children:(0,s.jsx)(v,{onClick:t=>{t.stopPropagation(),e()},children:"Got it"})}),(0,s.jsx)(j,{})]})]})})};var m=r(32010);let OperatorCell=t=>{let{allValidatorsSigned:e,children:r}=t;return(0,s.jsx)(l.xv,{color:e?"body":"light",children:r})},SignedValidatorsCell=t=>{let{isActive:e,signedValidators:r,validatorsCount:a,showTooltip:n,onClick:i,onCloseTooltip:o}=t,c=r===a;return(0,s.jsxs)(l.kC,{css:{alignItems:"center",justifyContent:"space-between"},children:[(0,s.jsxs)(l.xv,{color:c?"body":"light",children:[r,"/",a]}),(0,s.jsx)(l.xu,{onClick:n||c?null:i,css:{cursor:"pointer",height:"24px",width:"25px"},children:c?(0,s.jsx)(l.nQ,{}):e?(0,s.jsx)(WaitingYellowIcon,{}):n?(0,s.jsxs)(l.xu,{css:{height:"24px"},children:[(0,s.jsx)(PartialExitsTooltip,{onClose:o}),(0,s.jsx)(l.ZG,{})]}):(0,s.jsx)(l.ZG,{})})]})},OperatorTable=t=>{let{operatorTableRef:e,validatorsCount:r,activeOperatorAddress:n,operatorsExits:o={},onClick:c}=t,{status:u}=(0,i.TY)((0,m.N)(t=>t.steps.find(t=>t.id===i.eI.MONITOR))),[x,h]=(0,a.useState)("complete"!==u),p=Object.entries(o).findIndex(t=>{let[e,s]=t;return s<r});return(0,s.jsx)(l.xu,{ref:e,children:(0,s.jsx)(l.iA,{rows:Object.entries(o).map((t,e)=>{let[a,i]=t;return{operator:(0,s.jsx)(OperatorCell,{allValidatorsSigned:i===r,children:(0,d.zN)(a,[0,6],5)}),signed_validators_count:(0,s.jsx)(SignedValidatorsCell,{showTooltip:p===e&&x,onCloseTooltip:()=>h(!1),isActive:n===a,signedValidators:i,validatorsCount:r,onClick:()=>c(a)})}}),columns:[{accessorKey:"operator",header:"operator"},{accessorKey:"signed_validators_count",header:"signed validators"}]})})},OperatorsDataContainer=t=>{let{operatorTableRef:e,operatorsExits:r,readyExits:a,activeOperatorAddress:n,onOperatorClick:o,onContinue:c,onBack:d}=t,{validatorsCount:u}=(0,i.TY)(t=>t.data);return(0,s.jsxs)(l.W2,{alignItems:"start",css:{gap:"$lg"},children:[(0,s.jsx)(l.xv,{variant:"h4",children:"Monitor the Partial Exits"}),(0,s.jsx)(ExitMonitorData,{}),(0,s.jsx)(OperatorTable,{operatorTableRef:e,activeOperatorAddress:n,operatorsExits:r,validatorsCount:u,onClick:o}),(0,s.jsxs)(l.kC,{css:{gap:"$xxs"},children:[(0,s.jsx)(l.xv,{children:"Validators ready to be Exited"}),(0,s.jsxs)(l.xv,{color:"obolGreen",children:[a," out of ",u]})]}),(0,s.jsx)(h.E,{onBack:d,onContinue:c})]})},NoValidatorsDataContainer=t=>{let{onContinue:e,onBack:r}=t;return(0,s.jsxs)(l.W2,{alignItems:"start",css:{gap:"$lg"},children:[(0,s.jsx)(l.xv,{variant:"h4",children:"Monitor the Partial Exits"}),(0,s.jsx)(l.xv,{css:{fontSize:"$4",fontWeight:"$semibold"},children:"Use Grafana to monitor the status of Partial Exits"}),(0,s.jsxs)(l.kC,{css:{height:"$7xl",borderRadius:"$1",border:"2px solid $bg04",backgroundColor:"$bg03",padding:"$sm"},children:[(0,s.jsx)(l.xv,{css:{display:"flex",mr:"$xxxs",height:"$lg",alignItems:"center"},children:"Read More Detail on"}),(0,s.jsx)(x.jk,{link:"https://docs.obol.org/next/learn/charon/cluster-configuration#cluster-size-and-resilience/start/quickstart_group#step-1-generate-an-enr",title:"Docs"})]}),(0,s.jsx)(h.E,{onBack:r,onContinue:e})]})};var b=r(31431);let useExitValidatorsData=t=>{let e=(0,u.UV)(t),[r,s]=(0,a.useState)(""),[n,i]=(0,a.useState)([]),[o,l]=(0,a.useState)(1),[c,d]=(0,a.useState)(1),[x,h]=(0,a.useState)(0),p=(0,a.useCallback)(()=>{s(""),i(e.data),l(1),d(e.totalPages),h(e.totalCount)},[e.data,e.totalPages,e.totalCount]),getValidatorsData=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2?arguments[2]:void 0;if(r||a||1!==e){let n={page:e};r&&(n.operatorAddress=r),a&&(n.validatorPubkey=a);let o=await (0,b.C4)("exp/exit/status/".concat(t),{params:n});s(r),i((null==o?void 0:o.cluster_exit_status)||[]),l(e),d(null==o?void 0:o.total_pages),h(null==o?void 0:o.total_count)}else p()};return(0,a.useEffect)(()=>{e.data&&p()},[e.data,p]),{activeOperatorAddress:r,currentPage:o,totalPages:c,totalCount:x,displayedValidatorsExitStatus:n,getValidatorsData}},useOutsideClick=(t,e)=>{(0,a.useEffect)(()=>{let handleClickOutside=r=>{var s;!t.current||(null===(s=t.current)||void 0===s?void 0:s.contains(r.target))||e()};return document.addEventListener("click",handleClickOutside),()=>{document.removeEventListener("click",handleClickOutside)}},[t,e])};var monitor=()=>{var t,e;let r=(0,n.useRouter)(),x=(0,d.xs)(r,"lockHash"),{activeOperatorAddress:h,currentPage:p,totalPages:g,totalCount:f,displayedValidatorsExitStatus:C,getValidatorsData:j}=useExitValidatorsData(x),v=(0,i.TY)(t=>t.completeStep),m=(0,i.TY)(t=>t.enableStep),b=(0,u.GE)(x),[E,k]=(0,a.useState)(""),S=(0,a.useRef)(null),onSubmit=()=>{v(i.eI.MONITOR);let t=m(i.eI.FETCH_BROADCAST);r.push(t.href)},handleClickOutside=async()=>{await j(1,"",E)},O=(0,a.useRef)(null);useOutsideClick(O,handleClickOutside);let handleOperatorClick=async t=>{h===t?await j(1,"",E):await j(1,t,E)},handlePageChange=async t=>{await j(t,h,E)},handleSearch=async t=>{k(t),S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{j(1,h,t)},2e3)};return(0,s.jsx)(o.rX,{useStore:i.TY,children:(0,s.jsx)(c.f,{children:(null==C?void 0:C.length)===0?(0,s.jsx)(NoValidatorsDataContainer,{onContinue:onSubmit,onBack:()=>r.push("".concat(i.xM.EXIT_COMMAND,"/?lockHash=").concat(x))}):(0,s.jsxs)(l.kC,{css:{gap:"$lg"},children:[(0,s.jsx)(OperatorsDataContainer,{operatorTableRef:O,operatorsExits:null==b?void 0:null===(t=b.data)||void 0===t?void 0:t.operator_exits,readyExits:null==b?void 0:null===(e=b.data)||void 0===e?void 0:e.ready_exits,activeOperatorAddress:h,onOperatorClick:handleOperatorClick,onContinue:onSubmit,onBack:()=>r.push("".concat(i.xM.EXIT_COMMAND,"/?lockHash=").concat(x))}),(0,s.jsx)(ValidatorsDataContainer,{searchValidatorValue:E,validatorsData:C,currentPage:p,totalCount:f,totalPages:g,onPageChange:handlePageChange,onValidatorSearch:handleSearch})]})})})}},32010:function(t,e,r){"use strict";r.d(e,{N:function(){return useShallow}});var s=r(67294);let{useRef:a}=s;function useShallow(t){let e=a();return r=>{let s=t(r);return!function(t,e){if(Object.is(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(let[r,s]of t)if(!Object.is(s,e.get(r)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(let r of t)if(!e.has(r))return!1;return!0}let r=Object.keys(t);if(r.length!==Object.keys(e).length)return!1;for(let s of r)if(!Object.prototype.hasOwnProperty.call(e,s)||!Object.is(t[s],e[s]))return!1;return!0}(e.current,s)?e.current=s:e.current}}}},function(t){t.O(0,[9774,2888,179],function(){return t(t.s=54839)}),_N_E=t.O()}]);